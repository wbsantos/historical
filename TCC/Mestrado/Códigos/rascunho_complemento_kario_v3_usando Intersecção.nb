(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     70425,       1748]
NotebookOptionsPosition[     67574,       1651]
NotebookOutlinePosition[     67920,       1666]
CellTagsIndexPosition[     67877,       1663]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", "CATemplates`"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChangeSymbols", "[", "core_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"newCore", "=", "core"}], ",", 
      RowBox[{"coreSymbols", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"core", ",", "#"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], "&"}]}],
              "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"core", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "0"}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "0", "]"}], "]"}], "===", "Symbol"}]}], "&"}]}], 
           "]"}], "]"}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "coreSymbols", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"newCore", "=", 
        RowBox[{"(", 
         RowBox[{"newCore", "/.", 
          RowBox[{
           RowBox[{"core", "[", 
            RowBox[{"[", 
             RowBox[{"coreSymbols", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "\[Rule]", 
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<x\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"Length", "[", "core", "]"}], "-", 
               RowBox[{"coreSymbols", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}]}], 
         ")"}]}]}], "]"}], ";", "\[IndentingNewLine]", "newCore"}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Problema", ":", 
     RowBox[{
     "Nome", " ", "das", " ", "vari\[AAcute]veis", " ", "s\[ATilde]o", " ", 
      "muito", " ", "importantes", " ", "para", " ", "correto", " ", 
      "funcionando"}]}], ",", 
    RowBox[{
    "mas", " ", "essa", " ", "depend\[EHat]ncia", " ", "n\[ATilde]o", " ", 
     "deveria", " ", "existis"}]}], "*)"}], 
  RowBox[{
   RowBox[{"ComplementaryTest", "[", "template1_Association", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"baseTemplate", "=", 
       RowBox[{"BaseTemplateCore", "[", 
        RowBox[{
         RowBox[{"k", "[", "template1", "]"}], ",", 
         RowBox[{"r", "[", "template1", "]"}]}], "]"}]}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"complementEquation", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "&"}], "/@", 
             RowBox[{"Map", "[", 
              RowBox[{"(*", 
               RowBox[{
               "Iguala", " ", "cada", " ", "campo", " ", "calculado", " ", 
                "ao", " ", "MOD", " ", "respectivo", " ", "para", " ", 
                "realizar", " ", "a", " ", "nega\[CCedilla]\[ATilde]o", " ", 
                "do", " ", "valor", " ", "da", " ", 
                "equa\[CCedilla]\[ATilde]o"}], "*)"}], 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"#", ",", "1"}], "]"}], "\[Equal]", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], "+", "w"}], ",", 
                   RowBox[{"k", "[", "template1", "]"}]}], "]"}]}], "&"}], 
               ",", 
               RowBox[{"Select", "[", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "Filtra", " ", "somente", " ", "as", " ", 
                   "posi\[CCedilla]\[OTilde]es", " ", "calculadas", " ", "do",
                    " ", "template"}], ",", 
                  RowBox[{
                  "ignorando", " ", "vari\[AAcute]veis", " ", "livres"}]}], 
                 "*)"}], 
                RowBox[{
                 RowBox[{"MapThread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#1", "===", "#2"}], ",", "\"\<X\>\"", ",", 
                    RowBox[{"#1", "\[Equal]", "#2"}]}], "]"}], "&"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ChangeSymbols", "[", 
                    RowBox[{"BaseTemplateCore", "[", 
                    RowBox[{
                    RowBox[{"k", "[", "template1", "]"}], ",", 
                    RowBox[{"r", "[", "template1", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"ChangeSymbols", "[", 
                    RowBox[{"templateCore", "[", "template1", "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"Not", "[", 
                   RowBox[{"#", "===", "\"\<X\>\""}], "]"}], "&"}]}], "]"}]}],
               "]"}]}], ")"}], "/.", 
           RowBox[{"w", "\[Rule]", "#"}]}], " ", 
          RowBox[{"(*", 
           RowBox[{
           "Substitu\[IAcute]", " ", "a", " ", "vari\[AAcute]vel", " ", "w", 
            " ", "pelo", " ", "valor", " ", "respectivo", " ", "da", " ", 
            "iterea\[CCedilla]\[ATilde]o", " ", "do", " ", "MOD"}], "*)"}], 
          ")"}], "&"}], "/@", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Mapeia", " ", "cada", " ", "campo", " ", "calculado", " ", "com", 
           " ", "a", " ", "itera\[CCedilla]\[ATilde]o", " ", "de", " ", "1", 
           " ", "\[AGrave]", " ", "k"}], "-", 
          RowBox[{
          "1", " ", "para", " ", "realizar", " ", "a", " ", 
           "opera\[CCedilla]\[ATilde]o", " ", "de", " ", "MOD", " ", "da", 
           " ", "nega\[CCedilla]\[ATilde]o"}]}], "*)"}], 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"k", "[", "template1", "]"}], "-", "1"}]}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"listaComplemento", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"listaComplemento", ",", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
            RowBox[{
             RowBox[{"(", "  ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "\[Equal]", 
                    " ", "2"}], ",", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "-", " ", 
                 RowBox[{"k", "[", "template1", "]"}], " ", "+", " ", "0.1"}],
                 ")"}], "*", 
               RowBox[{
                RowBox[{"Abs", "[", " ", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "\[Equal]", 
                    " ", "2"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "-", " ", 
                    RowBox[{"k", "[", "template1", "]"}]}], ")"}], " ", "+", 
                    " ", "0.1"}], ")"}], ",", " ", 
                   RowBox[{"k", "[", "template1", "]"}]}], "]"}], "]"}], " ", 
                "/", " ", 
                RowBox[{"Abs", "[", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "\[Equal]", 
                    " ", "2"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "-", " ", 
                   RowBox[{"k", "[", "template1", "]"}], " ", "+", " ", 
                   "0.1"}], ")"}], "]"}]}]}], ")"}], " ", "-", " ", "0.1"}]}],
            "  ", "&"}], " ", ",", " ", 
          RowBox[{"complementEquation", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"e", " ", "=", " ", "2"}], ",", " ", 
        RowBox[{"e", " ", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "complementEquation", "]"}]}], ",", " ", 
        RowBox[{"e", "++"}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"listaComplemento", ",", " ", 
          RowBox[{"complementEquation", "[", 
           RowBox[{"[", "e", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "listaComplemento"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7213119391967325`*^9, 3.7213119490152736`*^9}, 
   3.721315368814711*^9, {3.72131635172103*^9, 3.7213163754431705`*^9}, {
   3.721316442647564*^9, 3.7213165188606234`*^9}, {3.7213166022121687`*^9, 
   3.721316605003888*^9}, {3.7213166421627436`*^9, 3.721316692567815*^9}, {
   3.7213168375453367`*^9, 3.7213168384115353`*^9}, {3.721317141398978*^9, 
   3.72131717262553*^9}, {3.721317295855425*^9, 3.7213173489581857`*^9}, {
   3.721317440134726*^9, 3.721317489124405*^9}, {3.721317521238695*^9, 
   3.721317521727817*^9}, {3.7213175646389484`*^9, 3.721317565160084*^9}, {
   3.721317605059384*^9, 3.721317609546545*^9}, {3.721317641855908*^9, 
   3.721317725976706*^9}, {3.7213178675193386`*^9, 3.72131787069316*^9}, {
   3.7213179760094423`*^9, 3.721318051934579*^9}, {3.7213180979174805`*^9, 
   3.721318216004017*^9}, {3.7213182593742676`*^9, 3.7213183462302866`*^9}, {
   3.7213183917600803`*^9, 3.721318401416569*^9}, 3.7213184518556085`*^9, {
   3.721318507827112*^9, 3.721318509494525*^9}, {3.7213190483623037`*^9, 
   3.721319101121932*^9}, {3.721319150754806*^9, 3.721319222595502*^9}, {
   3.7213195561994905`*^9, 3.7213197899789944`*^9}, {3.7213198652264967`*^9, 
   3.7213198987401447`*^9}, {3.7213199347724943`*^9, 3.721319981086483*^9}, {
   3.7213207486355677`*^9, 3.7213207552582808`*^9}, {3.721320788105912*^9, 
   3.721320799448848*^9}, {3.721320852136484*^9, 3.721320853735899*^9}, {
   3.7213213425258017`*^9, 3.721321432604127*^9}, {3.721321524599275*^9, 
   3.721321527927408*^9}, {3.7213216050919495`*^9, 3.721321693558357*^9}, {
   3.7213217587806363`*^9, 3.7213218215381737`*^9}, {3.72132186764772*^9, 
   3.721321939598983*^9}, {3.7213413240642242`*^9, 3.7213413571907434`*^9}, {
   3.721342400431984*^9, 3.7213424061324854`*^9}, 3.7213461594355516`*^9, {
   3.721346322985114*^9, 3.7213463687858973`*^9}, {3.721346446442734*^9, 
   3.7213464612650046`*^9}, {3.7214269441444016`*^9, 3.721427059710376*^9}, {
   3.7214604488629746`*^9, 3.721460499384799*^9}, {3.721460554398514*^9, 
   3.7214606733691053`*^9}, 3.721460706574222*^9, {3.721460752846182*^9, 
   3.7214607612657146`*^9}, {3.7214608149125547`*^9, 3.721460816074007*^9}, {
   3.7214608950620437`*^9, 3.721460901806274*^9}, {3.7214611870097446`*^9, 
   3.721461197306642*^9}}],

Cell[BoxData[")"], "Input",
 CellChangeTimes->{3.721319650209834*^9}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"OperacaoDiferenca", "[", 
    RowBox[{"template1_Association", ",", "template2_Association"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"complementaryTemplate", " ", "=", " ", 
       RowBox[{"ComplementaryTest", "[", "template2", "]"}]}], " ", "}"}], 
     ",", 
     RowBox[{
      RowBox[{"totalItems", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "complementaryTemplate", "]"}], " ", ">", 
           " ", "0"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"complementaryTemplate", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", ">", " ", "0"}]}], 
         ",", "  ", 
         RowBox[{"Length", "[", 
          RowBox[{"complementaryTemplate", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", "0"}], "]"}]}], 
      ";", 
      RowBox[{"lista", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", " ", 
      RowBox[{"templates", " ", "=", 
       RowBox[{"{", "}"}]}], ";", " ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"u", "=", "1"}], ",", 
        RowBox[{"u", "\[LessEqual]", "totalItems"}], ",", 
        RowBox[{"u", "++"}], ",", " ", 
        RowBox[{"AppendTo", "[", " ", 
         RowBox[{"lista", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "u", "]"}], "]"}], " ", "&"}], " ", "/@", "  ", 
           "complementaryTemplate"}]}], "]"}]}], "]"}], ";", " ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"v", "=", "1"}], ",", 
        RowBox[{"v", "\[LessEqual]", 
         RowBox[{"Length", "[", "lista", "]"}]}], ",", 
        RowBox[{"v", "++"}], ",", " ", 
        RowBox[{"AppendTo", "[", " ", 
         RowBox[{"templates", ",", " ", 
          RowBox[{"BuildTemplate", "[", 
           RowBox[{
            RowBox[{"k", "[", "template1", "]"}], ",", 
            RowBox[{"r", "[", "template1", "]"}], ",", " ", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", " ", "===", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"lista", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], " ", "/@", 
                   " ", 
                   RowBox[{"lista", "[", 
                    RowBox[{"[", "v", "]"}], "]"}]}], ")"}], " ", ",", "#"}], 
                "]"}], " ", "&"}], ",", 
              RowBox[{"BaseTemplateCore", "[", 
               RowBox[{
                RowBox[{"k", "[", "template1", "]"}], ",", 
                RowBox[{"r", "[", "template1", "]"}]}], "]"}]}], "]"}]}], 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"coreList", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"templateBase", " ", "=", " ", 
       RowBox[{"BuildTemplate", "[", 
        RowBox[{
         RowBox[{"k", "[", "template1", "]"}], ",", 
         RowBox[{"r", "[", "template1", "]"}], ",", " ", 
         RowBox[{"BaseTemplateCore", "[", 
          RowBox[{
           RowBox[{"k", "[", "template1", "]"}], ",", 
           RowBox[{"r", "[", "template1", "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"h", " ", "=", " ", "1"}], ",", 
        RowBox[{"h", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", 
          RowBox[{"lista", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"h", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"t", "=", "1"}], ",", 
          RowBox[{"t", "\[LessEqual]", 
           RowBox[{"Length", "[", "lista", "]"}]}], ",", 
          RowBox[{"t", "++"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"coreList", ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", " ", "===", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"lista", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], " ", "/@", 
                    " ", 
                    RowBox[{"lista", "[", 
                    RowBox[{"[", "t", "]"}], "]"}]}], ")"}], "[", 
                  RowBox[{"[", "h", "]"}], "]"}], ",", " ", 
                 RowBox[{
                  RowBox[{"templateCore", "[", "templateBase", "]"}], "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"BaseTemplateCore", "[", 
                    RowBox[{
                    RowBox[{"k", "[", "template1", "]"}], ",", 
                    RowBox[{"r", "[", "template1", "]"}]}], "]"}], ",", " ", 
                    "#"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
               " ", "&"}], ",", 
              RowBox[{"BaseTemplateCore", "[", 
               RowBox[{
                RowBox[{"k", "[", "template1", "]"}], ",", 
                RowBox[{"r", "[", "template1", "]"}]}], "]"}]}], "]"}]}], 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"templateNegado", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"BuildTemplate", "[", 
          RowBox[{
           RowBox[{"k", "[", "template1", "]"}], ",", 
           RowBox[{"r", "[", "template1", "]"}], ",", " ", "#", ",", " ", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"DeleteDuplicates", "[", " ", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"postExpansionFn", "[", "template1", "]"}], ",", 
                 "FilterNotAllowed"}], "}"}], "]"}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{"#", " ", "=!=", " ", "IdentityFn"}], " ", "&"}]}], 
            "]"}]}], "]"}], " ", "&"}], " ", "/@", " ", "coreList"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"TemplateIntersection", "[", 
         RowBox[{"template1", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
       "templateNegado"}]}]}], "\[IndentingNewLine]", " ", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7213119521410832`*^9, 3.7213119938172026`*^9}, {
   3.7213122216011415`*^9, 3.721312232926076*^9}, {3.7213122639891276`*^9, 
   3.7213123988990326`*^9}, {3.72131248719991*^9, 3.721312512758512*^9}, {
   3.7213125451480536`*^9, 3.7213125609132757`*^9}, {3.721312591150812*^9, 
   3.7213126548330717`*^9}, {3.721312970879241*^9, 3.7213130648785405`*^9}, {
   3.7213131063512897`*^9, 3.7213131694686213`*^9}, {3.721313225815222*^9, 
   3.721313266253688*^9}, {3.7213133128667383`*^9, 3.721313383414012*^9}, {
   3.721313513784728*^9, 3.721313624247341*^9}, {3.721313764184534*^9, 
   3.7213138743954067`*^9}, {3.721314075610896*^9, 3.721314206837831*^9}, {
   3.7213142369641485`*^9, 3.721314241136036*^9}, {3.721314396246498*^9, 
   3.7213145262025986`*^9}, {3.7213145839978504`*^9, 3.721314859048499*^9}, {
   3.721314939376568*^9, 3.7213149818395433`*^9}, 3.7213150244585876`*^9, {
   3.721315081378319*^9, 3.7213151340839596`*^9}, {3.7213151824944897`*^9, 
   3.7213152813810816`*^9}, {3.7213161698899713`*^9, 3.721316236314162*^9}, {
   3.7213168859358363`*^9, 3.7213168865550213`*^9}, 3.7213188353268776`*^9, {
   3.721318866275879*^9, 3.7213188808826575`*^9}, {3.7213192685690656`*^9, 
   3.721319296783377*^9}, {3.7213193634076195`*^9, 3.721319452148559*^9}, 
   3.721319537944765*^9, {3.7213220167123795`*^9, 3.7213220483938336`*^9}, {
   3.7213220985621223`*^9, 3.7213221712416506`*^9}, {3.721322244817705*^9, 
   3.7213222454583535`*^9}, {3.7213224011274004`*^9, 
   3.7213224779976263`*^9}, {3.7213225203779593`*^9, 3.721322553109516*^9}, {
   3.7213393962453184`*^9, 3.7213394040063267`*^9}, {3.721339461590233*^9, 
   3.721339510117764*^9}, {3.7213395943265843`*^9, 3.721339594969751*^9}, {
   3.721339675018496*^9, 3.7213397055233765`*^9}, {3.721339747112155*^9, 
   3.7213397861932697`*^9}, {3.721339821699444*^9, 3.7213398494336157`*^9}, {
   3.7213399235229163`*^9, 3.7213400184724855`*^9}, {3.7213402364539075`*^9, 
   3.721340252081952*^9}, 3.7213404581702857`*^9, {3.721340539686388*^9, 
   3.7213405402785425`*^9}, {3.7213405939534063`*^9, 3.7213406693207073`*^9}, 
   3.7213407490958586`*^9, {3.721340942558793*^9, 3.7213410142452097`*^9}, {
   3.72134112284529*^9, 3.721341128876816*^9}, {3.721341208755462*^9, 
   3.7213412295520935`*^9}, {3.721341656635338*^9, 3.721341657238948*^9}, {
   3.7213451890129395`*^9, 3.7213452163150067`*^9}, {3.721345482646339*^9, 
   3.7213454870405025`*^9}, {3.721345528561221*^9, 3.72134553610419*^9}, {
   3.72134558258738*^9, 3.721345643134959*^9}, {3.72134583747534*^9, 
   3.7213458863376026`*^9}, {3.7213465366423945`*^9, 
   3.7213465432837853`*^9}, {3.721420794552812*^9, 3.7214208222770014`*^9}, {
   3.721420855216527*^9, 3.72142087388033*^9}, {3.7214209040610123`*^9, 
   3.721420910614278*^9}, 3.7214209482187557`*^9, {3.721421093744446*^9, 
   3.721421183835748*^9}, {3.721421219513997*^9, 3.721421222255684*^9}, {
   3.7214212885998507`*^9, 3.7214213404782777`*^9}, {3.7214213767506914`*^9, 
   3.7214213975910854`*^9}, 3.7214220652419643`*^9, {3.721423573470001*^9, 
   3.721423593980487*^9}, 3.721423648579617*^9, 3.721424070232253*^9, {
   3.7214270802767177`*^9, 3.721427094530414*^9}, 3.721427213914116*^9, {
   3.721427471842347*^9, 3.721427487115961*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ComplementaryTest", "[", 
  RowBox[{"BuildTemplate", "[", 
   RowBox[{"2", ",", " ", "0.5", ",", " ", 
    RowBox[{"{", 
     RowBox[{"x3", ",", 
      RowBox[{"x3", " ", "+", " ", "1"}], ",", "x1", ",", "x0"}], "}"}], ",", 
    " ", "FilterOutOfRange"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7213160700531034`*^9, 3.721316073005895*^9}, {
  3.721426707659791*^9, 3.721426715188329*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x2", "\[Equal]", 
     RowBox[{
      RowBox[{"-", "0.1`"}], "+", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.9`"}], "+", "x3"}], ",", "2"}], "]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"x2", "\[Equal]", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"2", "+", "x3"}], ",", "2"}], "]"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.721426715688301*^9, 3.72142706433893*^9, {3.721427491658597*^9, 
   3.721427498182082*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"OperacaoDiferenca", "[", 
   RowBox[{
    RowBox[{"BuildTemplate", "[", 
     RowBox[{"2", ",", " ", "0.5", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x3", ",", 
        RowBox[{"x3", " ", "+", " ", "1"}], ",", "x1", ",", "x0"}], "}"}], 
      ",", " ", "FilterOutOfRange"}], "]"}], ",", " ", 
    RowBox[{"BuildTemplate", "[", 
     RowBox[{"2", ",", " ", "0.5", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x3", ",", "x2", ",", 
        RowBox[{"x3", " ", "+", " ", "1"}], ",", 
        RowBox[{"x3", " ", "+", " ", "1"}]}], "}"}]}], "]"}]}], "]"}], " ", 
  RowBox[{"(*", "  ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "k"}], ")"}], "+", "0.1"}], ")"}], " ", "%", " ", 
     "k"}], "-", "0.1"}], "  ", "*)"}]}]], "Input",
 CellChangeTimes->{
  3.7213169567871985`*^9, {3.721317085261422*^9, 3.721317099088028*^9}, {
   3.72131899415899*^9, 3.7213189999114532`*^9}, {3.7213395212826796`*^9, 
   3.7213395377359385`*^9}, {3.721341239735741*^9, 3.721341249411954*^9}, {
   3.7213413319785013`*^9, 3.7213413339368258`*^9}, {3.7213416876341085`*^9, 
   3.721341699099758*^9}, {3.7213424192668743`*^9, 3.7213424536987696`*^9}, {
   3.721342617417446*^9, 3.7213426224927597`*^9}, {3.7213442415806665`*^9, 
   3.7213443266176753`*^9}, {3.7213443656367736`*^9, 
   3.7213444042376347`*^9}, {3.721344446616602*^9, 3.721344550964605*^9}, {
   3.7213446063059063`*^9, 3.721344634278171*^9}, {3.721420717593672*^9, 
   3.7214207297568197`*^9}, {3.7214220780703125`*^9, 3.721422088532996*^9}, {
   3.721422122527792*^9, 3.7214221250184345`*^9}, {3.7214221623701296`*^9, 
   3.7214222014822536`*^9}, 3.7214235692348795`*^9, {3.7214266894175887`*^9, 
   3.7214266969108033`*^9}, 3.72142718844811*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"k\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"r\"\>", "\[Rule]", "0.5`"}], ",", 
     RowBox[{"\<\"core\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"y3", ",", 
        RowBox[{"1", "+", "y3"}], ",", 
        RowBox[{"0.1`", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1.`"}], "-", 
           FractionBox[
            RowBox[{"9.`", " ", 
             RowBox[{"Abs", "[", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "0.9`"}], "+", "y3"}], ",", "2.`"}], "]"}], 
              "]"}]}], 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"-", "0.9`"}], "+", "y3"}], "]"}]], "+", 
           FractionBox[
            RowBox[{"10.`", " ", "y3", " ", 
             RowBox[{"Abs", "[", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "0.9`"}], "+", "y3"}], ",", "2.`"}], "]"}], 
              "]"}]}], 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"-", "0.9`"}], "+", "y3"}], "]"}]]}], ")"}]}], ",", 
        "x0"}], "}"}]}], ",", 
     RowBox[{"\<\"postExpansionFn\"\>", "\[Rule]", "FilterOutOfRange"}]}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"k\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"r\"\>", "\[Rule]", "0.5`"}], ",", 
     RowBox[{"\<\"core\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"y3", ",", 
        RowBox[{"1", "+", "y3"}], ",", "x1", ",", 
        RowBox[{"0.1`", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1.`"}], "-", 
           FractionBox[
            RowBox[{"9.`", " ", 
             RowBox[{"Abs", "[", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "0.9`"}], "+", "y3"}], ",", "2.`"}], "]"}], 
              "]"}]}], 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"-", "0.9`"}], "+", "y3"}], "]"}]], "+", 
           FractionBox[
            RowBox[{"10.`", " ", "y3", " ", 
             RowBox[{"Abs", "[", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "0.9`"}], "+", "y3"}], ",", "2.`"}], "]"}], 
              "]"}]}], 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"-", "0.9`"}], "+", "y3"}], "]"}]]}], ")"}]}]}], 
       "}"}]}], ",", 
     RowBox[{"\<\"postExpansionFn\"\>", "\[Rule]", "FilterOutOfRange"}]}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"k\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"r\"\>", "\[Rule]", "0.5`"}], ",", 
     RowBox[{"\<\"core\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\<\"postExpansionFn\"\>", "\[Rule]", "FilterOutOfRange"}]}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"k\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"r\"\>", "\[Rule]", "0.5`"}], ",", 
     RowBox[{"\<\"core\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\<\"postExpansionFn\"\>", "\[Rule]", "FilterOutOfRange"}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7214207300458803`*^9, 3.721420919696372*^9, 3.7214209510234804`*^9, {
   3.721421113356494*^9, 3.7214211247774596`*^9}, 3.7214211879257936`*^9, 
   3.7214212251394243`*^9, 3.721421343925181*^9, 3.721421400402785*^9, {
   3.7214220668683863`*^9, 3.72142208899411*^9}, 3.72142212577164*^9, {
   3.7214221646116953`*^9, 3.7214221761516695`*^9}, {3.721423569907051*^9, 
   3.721423596430119*^9}, 3.721423883638958*^9, 3.721424072158761*^9, {
   3.721427075563918*^9, 3.721427097592907*^9}, 3.7214272163506393`*^9, 
   3.7214274994789596`*^9, 3.7214604258285513`*^9, 3.721460712013103*^9, 
   3.7214608218948464`*^9, 3.7214609056815724`*^9, 3.7214612000963545`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListasIguais", "[", 
   RowBox[{"lista1_List", ",", " ", "lista2_List"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Sort", "[", "lista1", "]"}], " ", "===", " ", 
   RowBox[{"Sort", "[", "lista2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7213423691269083`*^9, 3.7213423912486334`*^9}, {
  3.721342650056893*^9, 3.721342701491232*^9}, {3.7213433056726265`*^9, 
  3.7213433212846947`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListasIguais", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "2"}], "}"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "1"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.721342703461734*^9, 3.72134271936383*^9}, {
  3.7213433262479787`*^9, 3.721343349250932*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.7213427156738873`*^9, 3.7213427198829794`*^9}, {
   3.721343323747304*^9, 3.7213433500311193`*^9}, 3.7213467361932507`*^9, 
   3.721461442222041*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListasDiferenca", "[", 
   RowBox[{"lista1_List", ",", " ", "lista2_List"}], "]"}], " ", ":=", " ", 
  RowBox[{"Select", "[", 
   RowBox[{"lista1", ",", 
    RowBox[{
     RowBox[{"ContainsNone", "[", 
      RowBox[{"lista2", ",", " ", 
       RowBox[{"{", "#", "}"}]}], "]"}], " ", "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7213435193834763`*^9, 3.7213436950307407`*^9}, {
   3.7213440159182568`*^9, 3.7213440565397635`*^9}, {3.721344113969632*^9, 
   3.7213441226698923`*^9}, 3.721344703361226*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListasDiferenca", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "2"}], "}"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "1"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{3.7213437048549805`*^9, 3.7213447076253242`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", 
    ",", "2"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7213437051674733`*^9, {3.7213440596475935`*^9, 3.7213440720947742`*^9}, 
   3.721344124942453*^9, 3.721344708077449*^9, 3.7213467449873486`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandirOperacaoDiferenca", "[", 
   RowBox[{"template1_Association", ",", "template2_Association"}], "]"}], 
  " ", ":=", " ", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"ExpandTemplate", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
       RowBox[{"OperacaoDiferenca", "[", 
        RowBox[{"template1", ",", " ", "template2"}], "]"}]}], ")"}], ",", 
     " ", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7213438148462*^9, 3.7213438202836018`*^9}, {
   3.7213438528470507`*^9, 3.721343863911915*^9}, {3.7213439222240143`*^9, 
   3.7213439867186947`*^9}, {3.721344142312975*^9, 3.7213441684287205`*^9}, 
   3.721344222617734*^9, {3.7213446473085165`*^9, 3.7213446741746664`*^9}, {
   3.721344955049387*^9, 3.721344958384242*^9}, {3.7213451024265037`*^9, 
   3.721345115174814*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestarOperacaoDiferenca", "[", 
   RowBox[{"template1_Association", ",", "template2_Association"}], "]"}], 
  " ", ":=", " ", 
  RowBox[{"ListasIguais", "[", 
   RowBox[{
    RowBox[{"ListasDiferenca", "[", 
     RowBox[{
      RowBox[{"ExpandTemplate", "[", "template1", "]"}], ",", " ", 
      RowBox[{"ExpandTemplate", "[", "template2", "]"}]}], "]"}], ",", " ", 
    RowBox[{"ExpandirOperacaoDiferenca", "[", 
     RowBox[{"template1", ",", " ", "template2"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7213446804493046`*^9, 3.721344693210619*^9}, {
  3.7213447236735044`*^9, 3.721344788961403*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestarOperacaoDiferenca", "[", 
  RowBox[{
   RowBox[{"ColorBlindTemplate", "[", 
    RowBox[{"3", ",", " ", "0.5"}], "]"}], ",", " ", 
   RowBox[{"StateConservingTemplate", "[", 
    RowBox[{"3", ",", " ", "0.5"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7213447911049433`*^9, 3.72134480545467*^9}, {
  3.721344968948984*^9, 3.721344978151353*^9}, {3.72134593360058*^9, 
  3.7213459834608545`*^9}, {3.721346069190419*^9, 3.7213460734404297`*^9}, {
  3.7213465725759115`*^9, 3.7213465991507187`*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.721344809454693*^9, {3.721344963624591*^9, 3.721344978550454*^9}, 
   3.7213451179505224`*^9, 3.7213459290206995`*^9, 3.721345984163955*^9, 
   3.7213460580656157`*^9, 3.7213464092779446`*^9, 3.7213464726224413`*^9, {
   3.721346550423997*^9, 3.721346599635104*^9}, 3.7213467495185976`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sort", "[", 
  RowBox[{"ExpandirOperacaoDiferenca", "[", " ", 
   RowBox[{
    RowBox[{"ColorBlindTemplate", "[", 
     RowBox[{"3", ",", " ", "0.5"}], "]"}], ",", " ", 
    RowBox[{"StateConservingTemplate", "[", 
     RowBox[{"3", ",", " ", "0.5"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7213460782817497`*^9, 3.721346129153633*^9}, {
   3.7213461849545126`*^9, 3.72134618556564*^9}, {3.721346380725591*^9, 
   3.7213464351312785`*^9}, 3.7213465100685873`*^9, 3.721346569599496*^9, {
   3.7213466041037264`*^9, 3.721346608850479*^9}, {3.721346862118681*^9, 
   3.721346863509308*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "2", ",", "1", ",", "2",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "1", ",", "0", ",", "2", ",", "1", ",", "0", ",", "2", ",", "1",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "2", ",", "2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0",
      ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7213460631988907`*^9, 3.7213460951939583`*^9}, 
   3.7213461359052734`*^9, 3.7213461860287695`*^9, {3.7213463775314703`*^9, 
   3.721346394811767*^9}, {3.7213464292668896`*^9, 3.721346435678153*^9}, 
   3.7213464666849685`*^9, 3.7213465105217257`*^9, {3.7213465469396315`*^9, 
   3.7213465702657924`*^9}, {3.7213466046506157`*^9, 3.721346609381729*^9}, 
   3.7213467507249618`*^9, 3.7213467952532606`*^9, 3.7213468639624176`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListasDiferenca", "[", 
  RowBox[{
   RowBox[{"ExpandTemplate", "[", 
    RowBox[{"ColorBlindTemplate", "[", 
     RowBox[{"3", ",", " ", "0.5"}], "]"}], "]"}], ",", " ", 
   RowBox[{"ExpandTemplate", "[", 
    RowBox[{"StateConservingTemplate", "[", 
     RowBox[{"3", ",", " ", "0.5"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.721346238230925*^9, 3.721346297677369*^9}, {
  3.7213466290774145`*^9, 3.7213466417689147`*^9}, {3.7213467913810053`*^9, 
  3.7213467922845163`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
   "2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "2", ",", "1", ",", "2", 
    ",", "0"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.721346232059022*^9, 3.7213462979898677`*^9}, 
   3.721346642940775*^9, {3.7213467002335415`*^9, 3.7213467104458117`*^9}, 
   3.7213467531719875`*^9, {3.7213467928001156`*^9, 3.721346797115503*^9}, 
   3.7213468750912576`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ColorBlindTemplate", "[", 
  RowBox[{"3", ",", " ", "0.5"}], "]"}]], "Input",
 CellChangeTimes->{{3.7213466763289413`*^9, 3.721346697842913*^9}, {
  3.721346785005748*^9, 3.721346824538393*^9}, {3.721347047266322*^9, 
  3.7213470515944595`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"k\"\>", "\[Rule]", "3"}], ",", 
   RowBox[{"\<\"r\"\>", "\[Rule]", "0.5`"}], ",", 
   RowBox[{"\<\"core\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", 
      RowBox[{"2", "-", "x1"}], ",", 
      RowBox[{"2", "-", 
       RowBox[{"2", " ", "x1"}]}], ",", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "x1"}]}], ",", "1", ",", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "x1"}]}], ",", 
      RowBox[{"2", " ", "x1"}], ",", "x1", ",", "0"}], "}"}]}], ",", 
   RowBox[{"\<\"postExpansionFn\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"FilterNotAllowed", ",", "ModK"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.7213470519538164`*^9, 3.721348285742432*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StateConservingTemplate", "[", 
  RowBox[{"3", ",", " ", "0.5"}], "]"}]], "Input",
 CellChangeTimes->{{3.721346816723083*^9, 3.7213468283205976`*^9}, {
  3.721346912315662*^9, 3.7213469138312902`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"k\"\>", "\[Rule]", "3"}], ",", 
   RowBox[{"\<\"r\"\>", "\[Rule]", "0.5`"}], ",", 
   RowBox[{"\<\"core\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", 
      RowBox[{"2", "+", "x1", "-", "x2"}], ",", 
      RowBox[{"2", "-", "x2"}], ",", 
      RowBox[{"1", "-", "x1", "+", "x2"}], ",", "1", ",", 
      RowBox[{"1", "-", "x1"}], ",", "x2", ",", "x1", ",", "0"}], "}"}]}], 
   ",", 
   RowBox[{"\<\"postExpansionFn\"\>", "\[Rule]", "FilterOutOfRange"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.721346817207432*^9, 3.7213468288518353`*^9}, 
   3.721346914471901*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OperacaoDiferenca", "[", " ", 
   RowBox[{
    RowBox[{"ColorBlindTemplate", "[", 
     RowBox[{"3", ",", " ", "0.5"}], "]"}], ",", " ", 
    RowBox[{"StateConservingTemplate", "[", 
     RowBox[{"3", ",", " ", "0.5"}], "]"}]}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7213469806828094`*^9, 3.7213470290777225`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll","reps",
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"2\\\", \
\\\"\[Equal]\\\", \\\"y8\\\"}], \\\",\\\", RowBox[{RowBox[{\\\"2\\\", \\\"-\\\
\", \\\"x1\\\"}], \\\"\[Equal]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"0.1`\\\"}], \\\"+\\\", FractionBox[RowBox[{RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.8999999999999999`\\\"}], \\\"+\\\", \\\"y1\\\
\", \\\"-\\\", \\\"y2\\\"}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"Abs\\\", \
\\\"[\\\", RowBox[{\\\"Mod\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"-\\\", \
\\\"0.9`\\\"}], \\\"+\\\", \\\"y1\\\", \\\"+\\\", RowBox[{\\\"Times\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]}], \\\",\\\", \\\"3\\\"}], \\\"]\\\"}], \\\"]\\\"}]}], \
RowBox[{\\\"Abs\\\", \\\"[\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"0.8999999999999999`\\\"}], \\\"+\\\", \\\"y1\\\", \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}]]}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"2\\\", \\\"-\\\", RowBox[{\\\"2\\\", \\\" \\\", \
\\\"x1\\\"}]}], \\\"\[Equal]\\\", \\\"y6\\\"}], \\\",\\\", RowBox[{RowBox[{\\\
\"1\\\", \\\"-\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"x1\\\"}]}], \
\\\"\[Equal]\\\", \\\"y5\\\"}], \\\",\\\", RowBox[{\\\"1\\\", \
\\\"\[Equal]\\\", \\\"y4\\\"}], \\\",\\\", RowBox[{RowBox[{\\\"1\\\", \\\"+\\\
\", RowBox[{\\\"2\\\", \\\" \\\", \\\"x1\\\"}]}], \\\"\[Equal]\\\", \
\\\"y3\\\"}], \\\",\\\", RowBox[{RowBox[{\\\"2\\\", \\\" \\\", \\\"x1\\\"}], \
\\\"\[Equal]\\\", \\\"y2\\\"}], \\\",\\\", RowBox[{\\\"x1\\\", \\\"\[Equal]\\\
\", \\\"y1\\\"}], \\\",\\\", RowBox[{\\\"0\\\", \\\"\[Equal]\\\", \
\\\"y0\\\"}]}], \\\"}\\\"}]\\) is neither a list of replacement rules nor a \
valid dispatch table, and so cannot be used for replacing.\"",2,43,20,
   29442348801332532996,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.721461205641181*^9}],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll","reps",
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"2\\\", \
\\\"\[Equal]\\\", \\\"y8\\\"}], \\\",\\\", RowBox[{RowBox[{\\\"2\\\", \\\"-\\\
\", \\\"x1\\\"}], \\\"\[Equal]\\\", \\\"y7\\\"}], \\\",\\\", RowBox[{RowBox[{\
\\\"2\\\", \\\"-\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"x1\\\"}]}], \\\"\
\[Equal]\\\", RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \
FractionBox[RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"0.8999999999999999`\\\"}], \\\"-\\\", \\\"y2\\\"}], \\\")\\\"}], \\\" \
\\\", RowBox[{\\\"Abs\\\", \\\"[\\\", RowBox[{\\\"Mod\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"0.9`\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\",\\\", \\\"3\\\"}], \
\\\"]\\\"}], \\\"]\\\"}]}], RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.8999999999999999`\\\"}], \\\"+\\\", RowBox[{\
\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}]]}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"1\\\", \\\"-\\\", RowBox[{\\\"2\\\", \\\" \\\", \
\\\"x1\\\"}]}], \\\"\[Equal]\\\", \\\"y5\\\"}], \\\",\\\", RowBox[{\\\"1\\\", \
\\\"\[Equal]\\\", \\\"y4\\\"}], \\\",\\\", RowBox[{RowBox[{\\\"1\\\", \\\"+\\\
\", RowBox[{\\\"2\\\", \\\" \\\", \\\"x1\\\"}]}], \\\"\[Equal]\\\", \
\\\"y3\\\"}], \\\",\\\", RowBox[{RowBox[{\\\"2\\\", \\\" \\\", \\\"x1\\\"}], \
\\\"\[Equal]\\\", \\\"y2\\\"}], \\\",\\\", RowBox[{\\\"x1\\\", \\\"\[Equal]\\\
\", \\\"y1\\\"}], \\\",\\\", RowBox[{\\\"0\\\", \\\"\[Equal]\\\", \
\\\"y0\\\"}]}], \\\"}\\\"}]\\) is neither a list of replacement rules nor a \
valid dispatch table, and so cannot be used for replacing.\"",2,43,21,
   29442348801332532996,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7214612056568065`*^9}],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll","reps",
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"2\\\", \
\\\"\[Equal]\\\", \\\"y8\\\"}], \\\",\\\", RowBox[{RowBox[{\\\"2\\\", \\\"-\\\
\", \\\"x1\\\"}], \\\"\[Equal]\\\", \\\"y7\\\"}], \\\",\\\", RowBox[{RowBox[{\
\\\"2\\\", \\\"-\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"x1\\\"}]}], \\\"\
\[Equal]\\\", \\\"y6\\\"}], \\\",\\\", RowBox[{RowBox[{\\\"1\\\", \\\"-\\\", \
RowBox[{\\\"2\\\", \\\" \\\", \\\"x1\\\"}]}], \\\"\[Equal]\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \
FractionBox[RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.9`\\\"}], \\\"-\\\", \\\"y1\\\", \\\"+\\\", \\\"y2\\\"}], \\\")\\\"}], \
\\\" \\\", RowBox[{\\\"Abs\\\", \\\"[\\\", RowBox[{\\\"Mod\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"1.9`\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \\\"y2\\\"}], \\\",\\\", \
\\\"3\\\"}], \\\"]\\\"}], \\\"]\\\"}]}], RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.9`\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\"+\\\", \\\"y2\\\"}], \\\"]\\\"}]]}]}], \\\",\\\", \
RowBox[{\\\"1\\\", \\\"\[Equal]\\\", \\\"y4\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"1\\\", \\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", \
\\\"x1\\\"}]}], \\\"\[Equal]\\\", \\\"y3\\\"}], \\\",\\\", RowBox[{RowBox[{\\\
\"2\\\", \\\" \\\", \\\"x1\\\"}], \\\"\[Equal]\\\", \\\"y2\\\"}], \\\",\\\", \
RowBox[{\\\"x1\\\", \\\"\[Equal]\\\", \\\"y1\\\"}], \\\",\\\", \
RowBox[{\\\"0\\\", \\\"\[Equal]\\\", \\\"y0\\\"}]}], \\\"}\\\"}]\\) is \
neither a list of replacement rules nor a valid dispatch table, and so cannot \
be used for replacing.\"",2,43,22,29442348801332532996,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.721461205672434*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"ReplaceAll\\\", \
\\\"::\\\", \\\"reps\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"",2,43,23,29442348801332532996,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.721461205688059*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"k\"\>", "\[Rule]", "3"}], ",", 
   RowBox[{"\<\"r\"\>", "\[Rule]", "0.5`"}], ",", 
   RowBox[{"\<\"core\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"\<\"postExpansionFn\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"FilterNotAllowed", ",", "ModK"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.721346888500827*^9, {3.7213469901318135`*^9, 3.721347029437087*^9}, 
   3.7213472241268916`*^9, 3.7213482475655513`*^9, 3.721461205688059*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpandTemplate", "[", 
  RowBox[{"BuildTemplate", "[", 
   RowBox[{"3", ",", " ", "0.5", ",", " ", 
    RowBox[{"{", 
     RowBox[{"2", " ", ",", 
      RowBox[{
       RowBox[{"2", "-", "x1"}], " ", "\[NotElement]", " ", 
       RowBox[{"{", "0", "}"}]}], ",", 
      RowBox[{"2", "-", 
       RowBox[{"2", " ", "x1"}]}], ",", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "x1"}]}], ",", "1", ",", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "x1"}]}], ",", 
      RowBox[{"2", " ", "x1"}], ",", "x1", ",", "0"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"FilterNotElement", ",", " ", "ModK"}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7213473440993023`*^9, 3.7213474694550037`*^9}, {
   3.7213481547885284`*^9, 3.7213481700974903`*^9}, {3.721348273426259*^9, 
   3.7213484258566847`*^9}, {3.7213485419437284`*^9, 
   3.7213485771478662`*^9}, {3.72134863060769*^9, 3.721348637830573*^9}, {
   3.7213488298122597`*^9, 3.7213488316987486`*^9}, 3.72134886601663*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"FilterNotElement", "[", 
    RowBox[{
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"k\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"r\"\>", "\[Rule]", "0.5`"}], ",", 
       RowBox[{"\<\"core\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{"2", "-", "x1"}], "\[NotElement]", 
           RowBox[{"{", "0", "}"}]}], ",", 
          RowBox[{"2", "-", 
           RowBox[{"2", " ", "x1"}]}], ",", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "x1"}]}], ",", "1", ",", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "x1"}]}], ",", 
          RowBox[{"2", " ", "x1"}], ",", "x1", ",", "0"}], "}"}]}], ",", 
       RowBox[{"\<\"postExpansionFn\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FilterNotElement", ",", "ModK"}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"2", "\[NotElement]", 
          RowBox[{"{", "0", "}"}]}], ",", "3"}], "]"}], ",", "2", ",", "1", 
       ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}], 
   ",", 
   RowBox[{"FilterNotElement", "[", 
    RowBox[{
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"k\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"r\"\>", "\[Rule]", "0.5`"}], ",", 
       RowBox[{"\<\"core\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{"2", "-", "x1"}], "\[NotElement]", 
           RowBox[{"{", "0", "}"}]}], ",", 
          RowBox[{"2", "-", 
           RowBox[{"2", " ", "x1"}]}], ",", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "x1"}]}], ",", "1", ",", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "x1"}]}], ",", 
          RowBox[{"2", " ", "x1"}], ",", "x1", ",", "0"}], "}"}]}], ",", 
       RowBox[{"\<\"postExpansionFn\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FilterNotElement", ",", "ModK"}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"1", "\[NotElement]", 
          RowBox[{"{", "0", "}"}]}], ",", "3"}], "]"}], ",", "0", ",", "2", 
       ",", "1", ",", "0", ",", "2", ",", "1", ",", "0"}], "}"}]}], "]"}], 
   ",", 
   RowBox[{"FilterNotElement", "[", 
    RowBox[{
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"k\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"r\"\>", "\[Rule]", "0.5`"}], ",", 
       RowBox[{"\<\"core\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{"2", "-", "x1"}], "\[NotElement]", 
           RowBox[{"{", "0", "}"}]}], ",", 
          RowBox[{"2", "-", 
           RowBox[{"2", " ", "x1"}]}], ",", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "x1"}]}], ",", "1", ",", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "x1"}]}], ",", 
          RowBox[{"2", " ", "x1"}], ",", "x1", ",", "0"}], "}"}]}], ",", 
       RowBox[{"\<\"postExpansionFn\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FilterNotElement", ",", "ModK"}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"0", "\[NotElement]", 
          RowBox[{"{", "0", "}"}]}], ",", "3"}], "]"}], ",", "1", ",", "0", 
       ",", "1", ",", "2", ",", "1", ",", "2", ",", "0"}], "}"}]}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.721347378411807*^9, 3.721347427536189*^9}, {
   3.7213474644705873`*^9, 3.7213474701756983`*^9}, 3.7213481561368756`*^9, {
   3.721348202409862*^9, 3.7213482140048547`*^9}, {3.721348276108926*^9, 
   3.721348387056655*^9}, {3.7213484216856184`*^9, 3.721348426440847*^9}, {
   3.7213485324102736`*^9, 3.7213485783781586`*^9}, 3.7213486389078255`*^9, 
   3.7213488323458977`*^9, 3.721348866984854*^9, 3.721461215175969*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7213473815222335`*^9, 3.7213473821628747`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FilterNotElement", "[", 
    RowBox[{"template_Association", ",", "expansion_List"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"memberQsInHold", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{"expansion", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"value_", "\[NotElement]", "set_List"}], "\[Rule]", 
           RowBox[{"Hold", "[", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"set", ",", "value"}], "]"}], "]"}]}], ")"}], ",", 
         "Infinity"}], "]"}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{"ReleaseHold", "/@", "memberQsInHold"}], ")"}]}], 
        "\[Equal]", "True"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "##", ")"}], "&"}], "[", "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "At", " ", "least", " ", "one", " ", "of", " ", "the", " ", 
          "expressions", " ", "is", " ", "invalid"}], ",", 
         RowBox[{
         "this", " ", "expansion", " ", "should", " ", "be", " ", 
          "filtered"}]}], "*)"}], 
       RowBox[{"expansion", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"value_", " ", "\[NotElement]", " ", "set_List"}], 
          "\[Rule]", "value"}], ")"}]}]}], "]"}]}], "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"All", " ", "expressions", " ", "are", " ", "valid"}], ",", 
    RowBox[{"this", " ", "expansion", " ", "is", " ", 
     RowBox[{"ok", "."}]}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.721348141274047*^9, 3.721348150505437*^9}, {
  3.721348194285777*^9, 3.721348210705011*^9}, {3.7213484818672075`*^9, 
  3.7213485498708076`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OperacaoDiferenca", "[", 
   RowBox[{
    RowBox[{"BuildTemplate", "[", 
     RowBox[{"2", ",", " ", "0.5", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x3", ",", 
        RowBox[{"x3", " ", "+", " ", "1"}], ",", "x1", ",", "x0"}], "}"}], 
      ",", " ", "FilterOutOfRange"}], "]"}], ",", " ", 
    RowBox[{"BuildTemplate", "[", 
     RowBox[{"2", ",", " ", "0.5", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x3", ",", "x2", ",", 
        RowBox[{"x3", " ", "+", " ", "1"}], ",", 
        RowBox[{"x3", " ", "+", " ", "1"}]}], "}"}]}], "]"}]}], "]"}], " ", 
  RowBox[{"(*", "  ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "k"}], ")"}], "+", "0.1"}], ")"}], " ", "%", " ", 
     "k"}], "-", "0.1"}], "  ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7214275185050135`*^9, 3.721427536818675*^9}, {
  3.721427691117964*^9, 3.7214277179617915`*^9}, {3.721428002801049*^9, 
  3.721428003863553*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"k\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"r\"\>", "\[Rule]", "0.5`"}], ",", 
     RowBox[{"\<\"core\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"y3", ",", 
        RowBox[{"1", "+", "y3"}], ",", 
        RowBox[{"0.1`", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1.`"}], "-", 
           FractionBox[
            RowBox[{"9.`", " ", 
             RowBox[{"Abs", "[", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "0.9`"}], "+", "y3"}], ",", "2.`"}], "]"}], 
              "]"}]}], 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"-", "0.9`"}], "+", "y3"}], "]"}]], "+", 
           FractionBox[
            RowBox[{"10.`", " ", "y3", " ", 
             RowBox[{"Abs", "[", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "0.9`"}], "+", "y3"}], ",", "2.`"}], "]"}], 
              "]"}]}], 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"-", "0.9`"}], "+", "y3"}], "]"}]]}], ")"}]}], ",", 
        "x0"}], "}"}]}], ",", 
     RowBox[{"\<\"postExpansionFn\"\>", "\[Rule]", "FilterOutOfRange"}]}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"k\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"r\"\>", "\[Rule]", "0.5`"}], ",", 
     RowBox[{"\<\"core\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"y3", ",", 
        RowBox[{"1", "+", "y3"}], ",", "x1", ",", 
        RowBox[{"0.1`", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1.`"}], "-", 
           FractionBox[
            RowBox[{"9.`", " ", 
             RowBox[{"Abs", "[", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "0.9`"}], "+", "y3"}], ",", "2.`"}], "]"}], 
              "]"}]}], 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"-", "0.9`"}], "+", "y3"}], "]"}]], "+", 
           FractionBox[
            RowBox[{"10.`", " ", "y3", " ", 
             RowBox[{"Abs", "[", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "0.9`"}], "+", "y3"}], ",", "2.`"}], "]"}], 
              "]"}]}], 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"-", "0.9`"}], "+", "y3"}], "]"}]]}], ")"}]}]}], 
       "}"}]}], ",", 
     RowBox[{"\<\"postExpansionFn\"\>", "\[Rule]", "FilterOutOfRange"}]}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"k\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"r\"\>", "\[Rule]", "0.5`"}], ",", 
     RowBox[{"\<\"core\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\<\"postExpansionFn\"\>", "\[Rule]", "FilterOutOfRange"}]}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"k\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"r\"\>", "\[Rule]", "0.5`"}], ",", 
     RowBox[{"\<\"core\"\>", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\<\"postExpansionFn\"\>", "\[Rule]", "FilterOutOfRange"}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.721427700867968*^9, 3.7214277193211555`*^9}, 
   3.7214280055970936`*^9, 3.721460845826675*^9, 3.7214612495739603`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ExpandTemplate", "[", 
  RowBox[{"BuildTemplate", "[", 
   RowBox[{"2", ",", " ", "0.5", ",", " ", 
    RowBox[{"{", 
     RowBox[{"x3", ",", 
      RowBox[{"x3", " ", "+", " ", "1"}], ",", "x1", ",", "x0"}], "}"}], ",", 
    " ", "FilterOutOfRange"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExpandTemplate", "[", " ", 
  RowBox[{"BuildTemplate", "[", 
   RowBox[{"2", ",", " ", "0.5", ",", " ", 
    RowBox[{"{", 
     RowBox[{"x3", ",", "x2", ",", 
      RowBox[{"x3", " ", "+", " ", "1"}], ",", 
      RowBox[{"x3", " ", "+", " ", "1"}]}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7214275596610355`*^9, 3.7214275757405467`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.721427578350837*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.721427578350837*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListasDiferenca", "[", 
  RowBox[{
   RowBox[{"ExpandTemplate", "[", 
    RowBox[{"BuildTemplate", "[", 
     RowBox[{"2", ",", " ", "0.5", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x3", ",", 
        RowBox[{"x3", " ", "+", " ", "1"}], ",", "x1", ",", "x0"}], "}"}], 
      ",", " ", "FilterOutOfRange"}], "]"}], "]"}], ",", 
   RowBox[{"ExpandTemplate", "[", " ", 
    RowBox[{"BuildTemplate", "[", 
     RowBox[{"2", ",", " ", "0.5", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x3", ",", "x2", ",", 
        RowBox[{"x3", " ", "+", " ", "1"}], ",", 
        RowBox[{"x3", " ", "+", " ", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.721427606074435*^9, 3.7214276115588512`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7214276119925375`*^9, 3.7214614504922657`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ExpandTemplate", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
    RowBox[{"OperacaoDiferenca", "[", 
     RowBox[{
      RowBox[{"BuildTemplate", "[", 
       RowBox[{"2", ",", " ", "0.5", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x3", ",", 
          RowBox[{"x3", " ", "+", " ", "1"}], ",", "x1", ",", "x0"}], "}"}]}],
        "]"}], ",", " ", 
      RowBox[{"BuildTemplate", "[", 
       RowBox[{"2", ",", " ", "0.5", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x3", ",", "x2", ",", 
          RowBox[{"x3", " ", "+", " ", "1"}], ",", 
          RowBox[{"x3", " ", "+", " ", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
   " ", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "k"}], ")"}], "+", "0.1"}], ")"}], " ", "%", " ", 
      "k"}], "-", "0.1"}], "  ", "*)"}], ",", " ", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.72142788177392*^9, 3.721427903124016*^9}, {
  3.721427964818356*^9, 3.7214279834812145`*^9}, {3.7214613889272428`*^9, 
  3.7214613896304398`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", 
     RowBox[{"-", "1.2000000000000002`"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", 
     RowBox[{"-", "1.2000000000000002`"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "0.`", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "0.`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", 
     RowBox[{"-", "1.2000000000000002`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", 
     RowBox[{"-", "1.2000000000000002`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "1", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7214279804460306`*^9, 3.721427983918704*^9}, {
   3.721460834988474*^9, 3.7214608495926332`*^9}, 3.721460916994485*^9, 
   3.721461224376586*^9, 3.721461389989848*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"calcular", "[", "y3_", "]"}], " ", ":=", " ", 
  RowBox[{"0.1`", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1.`"}], "-", 
     FractionBox[
      RowBox[{"9.`", " ", 
       RowBox[{"Abs", "[", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.9`"}], "+", "y3"}], ",", "2.`"}], "]"}], "]"}]}], 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"-", "0.9`"}], "+", "y3"}], "]"}]], "+", 
     FractionBox[
      RowBox[{"10.`", " ", "y3", " ", 
       RowBox[{"Abs", "[", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.9`"}], "+", "y3"}], ",", "2.`"}], "]"}], "]"}]}], 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"-", "0.9`"}], "+", "y3"}], "]"}]]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.721428107816393*^9, 3.7214281691601233`*^9}, {
  3.7214285456651993`*^9, 3.7214285521964417`*^9}, {3.7214609325176315`*^9, 
  3.7214610107396345`*^9}, {3.721461050694847*^9, 3.721461066431778*^9}, {
  3.7214612619696827`*^9, 3.721461262407222*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"calcular", "[", "0", "]"}]], "Input",
 CellChangeTimes->{{3.721428205031478*^9, 3.721428205406479*^9}, {
  3.721428363651621*^9, 3.721428379173153*^9}, {3.721428564717391*^9, 
  3.721428584251115*^9}, {3.7214286830513625`*^9, 3.721428813967292*^9}, {
  3.721428847198491*^9, 3.7214288781607533`*^9}, {3.7214610133299284`*^9, 
  3.72146103768839*^9}, {3.7214610704946203`*^9, 3.721461070572756*^9}, {
  3.7214612700678835`*^9, 3.7214613060607796`*^9}, {3.7214613693650103`*^9, 
  3.721461371943352*^9}, {3.721461669332637*^9, 3.7214616696920414`*^9}}],

Cell[BoxData[
 RowBox[{"-", "1.2000000000000002`"}]], "Output",
 CellChangeTimes->{{3.721428196130871*^9, 3.7214282062189674`*^9}, {
   3.7214283657297344`*^9, 3.721428370715785*^9}, 3.7214285654786935`*^9, {
   3.721428685150984*^9, 3.7214287054806137`*^9}, {3.7214287515900517`*^9, 
   3.721428814451665*^9}, {3.7214288512734575`*^9, 3.7214288786138525`*^9}, {
   3.721461015594941*^9, 3.7214610710884066`*^9}, {3.7214612647043033`*^9, 
   3.721461306529541*^9}, {3.7214613541409116`*^9, 3.7214613723652487`*^9}, 
   3.721461670207698*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{"Mod", "[", 
   RowBox[{
    RowBox[{"-", "0.9"}], ",", "2."}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.721460861220369*^9, 3.7214608790891485`*^9}}],

Cell[BoxData["1.1`"], "Output",
 CellChangeTimes->{{3.7214608718483353`*^9, 3.7214608797141857`*^9}}]
}, Open  ]]
},
WindowSize->{1898, 997},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 56, 1, 30, "Input"],
Cell[617, 23, 2096, 58, 69, "Input"],
Cell[2716, 83, 10505, 223, 316, "Input"],
Cell[13224, 308, 69, 1, 30, "Input"],
Cell[13296, 311, 10546, 220, 240, "Input"],
Cell[CellGroupData[{
Cell[23867, 535, 420, 9, 30, "Input"],
Cell[24290, 546, 570, 20, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24897, 571, 1798, 37, 30, "Input"],
Cell[26698, 610, 4089, 102, 118, "Output"]
}, Open  ]],
Cell[30802, 715, 429, 9, 30, "Input"],
Cell[CellGroupData[{
Cell[31256, 728, 859, 24, 30, "Input"],
Cell[32118, 754, 204, 3, 30, "Output"]
}, Open  ]],
Cell[32337, 760, 543, 12, 30, "Input"],
Cell[CellGroupData[{
Cell[32905, 776, 814, 23, 30, "Input"],
Cell[33722, 801, 345, 8, 30, "Output"]
}, Open  ]],
Cell[34082, 812, 929, 20, 30, "Input"],
Cell[35014, 834, 646, 14, 63, "Input"],
Cell[CellGroupData[{
Cell[35685, 852, 532, 10, 30, "Input"],
Cell[36220, 864, 347, 5, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36604, 874, 627, 12, 30, "Input"],
Cell[37234, 888, 925, 20, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38196, 913, 517, 11, 30, "Input"],
Cell[38716, 926, 424, 9, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39177, 940, 269, 5, 30, "Input"],
Cell[39449, 947, 784, 20, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40270, 972, 225, 4, 30, "Input"],
Cell[40498, 978, 673, 16, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41208, 999, 390, 9, 30, "Input"],
Cell[41601, 1010, 1994, 30, 44, "Message"],
Cell[43598, 1042, 1925, 29, 44, "Message"],
Cell[45526, 1073, 1960, 29, 44, "Message"],
Cell[47489, 1104, 343, 7, 21, "Message"],
Cell[47835, 1113, 559, 13, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48431, 1131, 1024, 23, 30, "Input"],
Cell[49458, 1156, 4075, 101, 69, "Output"]
}, Open  ]],
Cell[53548, 1260, 96, 1, 30, "Input"],
Cell[53647, 1263, 1809, 48, 69, "Input"],
Cell[CellGroupData[{
Cell[55481, 1315, 998, 26, 30, "Input"],
Cell[56482, 1343, 3546, 94, 118, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60065, 1442, 680, 15, 50, "Input"],
Cell[60748, 1459, 411, 11, 30, "Output"],
Cell[61162, 1472, 411, 11, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61610, 1488, 743, 18, 30, "Input"],
Cell[62356, 1508, 358, 9, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62751, 1522, 1161, 31, 30, "Input"],
Cell[63915, 1555, 1039, 25, 30, "Output"]
}, Open  ]],
Cell[64969, 1583, 1104, 30, 53, "Input"],
Cell[CellGroupData[{
Cell[66098, 1617, 574, 8, 30, "Input"],
Cell[66675, 1627, 541, 8, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67253, 1640, 201, 5, 30, "Input"],
Cell[67457, 1647, 101, 1, 30, "Output"]
}, Open  ]]
}
]
*)

